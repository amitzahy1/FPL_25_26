# 🎯 הסבר מפורט על חיזוי ML לדראפט FPL

## 📚 מה זה חיזוי הוריסטי (Heuristic Prediction)?

**חיזוי הוריסטי** הוא חיזוי שמבוסס על כללים פשוטים וניסיון, במקום על מודל מורכב של Machine Learning.

### למה משתמשים בו?

1. **מודל ML לא טוב** - המודל הנוכחי (Decision Tree) יש לו R² שלילי (-0.024), מה שאומר שהוא גרוע יותר מחיזוי הממוצע
2. **פשטות** - כללים פשוטים שקל להבין ולשנות
3. **אמינות** - מבוסס על מדדים מוכחים (form, ICT, transfers)

### איך זה עובד אצלנו?

החיזוי ההוריסטי משתמש ב-7 מדדים עיקריים:
- **form_5** (נקודות למשחק) - הבסיס לחיזוי
- **selected_by_percent** (אחוז בחירה) - פופולריות
- **transfers_balance** (מאזן העברות) - מגמה (שונה מ-transfers_in!)
- **minutes** (דקות משחק) - יציבות
- **ict_index** (ICT) - איכות ביצועים (חשיבות נמוכה)
- **xGI_per_90** (xGI למשחק) - איום התקפי
- **fixture_difficulty** (קושי משחקים) - משקלל את 3 המשחקים הבאים

---

## 🔍 המדדים והמטריקות - פירוט מלא

### 📊 **1. מודל Decision Tree - כל ה-Features (100+ מדדים)**

המודל משתמש ב-**100+ features** שונים. הנה החשובים ביותר:

#### 🏆 **Top 20 Features לפי חשיבות במודל:**

| # | Feature | חשיבות | הסבר |
|---|---------|--------|------|
| 1 | **form_10** | 22.87% | ממוצע נקודות ב-10 משחקים אחרונים |
| 2 | **selected** | 12.74% | אחוז בחירה (פופולריות) |
| 3 | **minutes** | 5.85% | דקות משחק כולל |
| 4 | **element** | 3.55% | ID שחקן |
| 5 | **transfers_in** | 3.43% | העברות פנימה |
| 6 | **transfers_out** | 3.09% | העברות החוצה |
| 7 | **xP** | 2.86% | נקודות כולל |
| 8 | **fixture** | 2.69% | משחק הבא |
| 9 | **transfers_balance** | 2.65% | מאזן העברות |
| 10 | **threat_per_90** | 2.53% | איום למשחק (90 דקות) |
| 11 | **threat** | 2.41% | איום כולל |
| 12 | **minutes_rolling** | 2.37% | ממוצע דקות |
| 13 | **points_cv** | 2.22% | מקדם שונות נקודות |
| 14 | **opponent_team** | 2.18% | קבוצה יריבה |
| 15 | **creativity_per_90** | 1.82% | יצירתיות למשחק |
| 16 | **creativity** | 1.67% | יצירתיות כולל |
| 17 | **influence** | 1.55% | השפעה |
| 18 | **points_std_5** | 1.47% | סטיית תקן נקודות (5 משחקים) |
| 19 | **expected_goals_conceded** | 1.45% | שערים צפויים שנספגו |
| 20 | **ict_index** | 1.29% | מדד ICT |

#### 📈 **קטגוריות Features במודל:**

##### **A. Form Features (צורה) - הכי חשובים!**
- `form_3` - ממוצע נקודות ב-3 משחקים אחרונים
- `form_5` - ממוצע נקודות ב-5 משחקים אחרונים ⭐
- `form_10` - ממוצע נקודות ב-10 משחקים אחרונים ⭐⭐⭐
- `form_trend` - מגמה (form_3 - form_5)

##### **B. Transfers (העברות)**
- `transfers_in` - העברות פנימה
- `transfers_out` - העברות החוצה
- `transfers_balance` - מאזן (פנימה - החוצה)

##### **C. ICT Index (איכות ביצועים)**
- `ict_index` - מדד ICT כולל
- `influence` - השפעה
- `creativity` - יצירתיות
- `threat` - איום
- `influence_per_90`, `creativity_per_90`, `threat_per_90` - למשחק

##### **D. Attacking (התקפה)**
- `goals_scored` - שערים
- `assists` - אסיסטים
- `expected_goals` (xG) - שערים צפויים
- `expected_assists` (xA) - אסיסטים צפויים
- `expected_goal_involvements` (xGI) - מעורבות בשערים
- `goals_per_90`, `assists_per_90`, `xG_per_90`, `xA_per_90`, `xGI_per_90` - למשחק

##### **E. Defensive (הגנה)**
- `clean_sheets` - משחקים נקיים
- `goals_conceded` - שערים שנספגו
- `expected_goals_conceded` - שערים צפויים שנספגו
- `saves` - הצלות (שוערים)
- `def_contrib` - תרומה הגנתית
- `def_contrib_per_90` - תרומה הגנתית למשחק

##### **F. Bonus Points**
- `bonus` - בונוס נקודות
- `bps` - BPS (Bonus Points System)
- `bonus_per_90`, `bps_per_90` - למשחק

##### **G. Advanced Stats**
- `key_passes` - מסירות מפתח
- `big_chances_created` - הזדמנויות גדולות שנוצרו
- `big_chances_missed` - הזדמנויות גדולות שהוחמצו
- `tackles`, `dribbles`, `fouls`, `offside` - סטטיסטיקות משחק

##### **H. Position (עמדה)**
- `is_GKP` - שוער (1 או 0)
- `is_DEF` - מגן (1 או 0)
- `is_MID` - קשר (1 או 0)
- `is_FWD` - חלוץ (1 או 0)

##### **I. Other**
- `selected` - אחוז בחירה
- `minutes` - דקות משחק
- `total_points` - נקודות כולל
- `starts` - פתיחות

---

### 🎯 **2. חיזוי הוריסטי - המדדים (עודכן!)**

החיזוי ההוריסטי פשוט יותר ומשתמש ב-**7 מדדים עיקריים**:

#### **הנוסחה (למשחק אחד):**

```javascript
heuristicPredPerGame = form_5  // בסיס: נקודות למשחק

// תיקונים:
+ 0.3  אם selected > 20%  (פופולרי)
+ 0.4  אם selected > 50%  (מאוד פופולרי)
+ 0.4  אם transfers_balance > 5,000  (מאזן חיובי)
+ 0.3  אם transfers_balance > 20,000  (מאזן מאוד חיובי)
- 0.3  אם transfers_balance < -5,000  (מאזן שלילי)
- 1.0  אם minutes < 300  (לא משחק הרבה)
+ 0.2  אם ict_index > 120  (ICT מאוד גבוה)
- 0.3  אם ict_index < 30 && minutes > 500  (ICT נמוך אבל משחק)
+ 0.3  אם xGI_per_90 > 0.5  (xGI טוב)

// כפל קושי משחקים:
× (0.8 + (fixture_difficulty - 1.0) * 0.4)
// קל: +20%, קשה: -20%

// חיזוי ל-3 מחזורים:
heuristicPred = heuristicPredPerGame × 3
```

#### **שינויים חשובים:**
1. ✅ **transfers_balance** במקום transfers_in (מדד טוב יותר!)
2. ✅ **חיזוי ל-3 מחזורים** במקום 1
3. ✅ **קושי משחקים** - משקלל את 3 המשחקים הבאים
4. ✅ **ICT Index** - משקל נמוך (רק 1.29% במודל)

#### **פירוט המדדים:**

| מדד | משקל | הסבר | דוגמה |
|-----|------|------|-------|
| **form_5** | 100% (בסיס) | נקודות למשחק - המדד הכי חשוב! | 6.5 נקודות/משחק = חיזוי בסיס 6.5 |
| **selected** | +0.3 / +0.4 | פופולריות - שחקנים פופולריים נוטים להיות טובים | >20% = +0.3, >50% = +0.7 |
| **transfers_balance** | +0.4 / +0.3 / -0.3 | מאזן העברות - מדד טוב יותר מ-transfers_in! | >5K = +0.4, >20K = +0.7, <-5K = -0.3 |
| **minutes** | -1.0 | דקות משחק - שחקן שלא משחק = לא טוב | <300 דקות = -1.0 |
| **ict_index** | +0.2 / -0.3 | ICT - חשיבות נמוכה (רק 1.29% במודל) | >120 = +0.2, <30 = -0.3 |
| **xGI_per_90** | +0.3 | xGI טוב = איום התקפי | >0.5 = +0.3 |
| **fixture_difficulty** | ×0.6-1.2 | קושי משחקים - משקלל 3 משחקים | קל: ×1.2, קשה: ×0.6 |

---

## 🎯 **איזה מדדים הכי חשובים?**

### **לפי המודל (Decision Tree):**

1. **form_10** (22.87%) - ממוצע נקודות ב-10 משחקים
2. **selected** (12.74%) - אחוז בחירה
3. **minutes** (5.85%) - דקות משחק

### **לפי החיזוי ההוריסטי:**

1. **form_5** (100% בסיס) - נקודות למשחק - **הכי חשוב!**
2. **selected** (+0.5/+1.0) - פופולריות
3. **minutes** (-1.0 אם נמוך) - יציבות
4. **ict_index** (+0.5) - איכות ביצועים
5. **transfers_in** (+0.3) - מגמה
6. **xGI_per_90** (+0.3) - איום התקפי

### **סיכום - המדדים הכי חשובים:**

#### 🥇 **1. Form (צורה) - 40% חשיבות**
- `form_5` / `points_per_game_90` - **הכי חשוב!**
- `form_10` - חשוב מאוד במודל
- `form_3` - חשוב למגמה

#### 🥈 **2. Selected (פופולריות) - 15% חשיבות**
- `selected_by_percent` - שחקנים פופולריים = בדרך כלל טובים

#### 🥉 **3. Minutes (דקות) - 10% חשיבות**
- `minutes` - שחקן שלא משחק = לא יכול להשיג נקודות

#### 4. **ICT Index - 10% חשיבות**
- `ict_index` - מדד איכות ביצועים

#### 5. **Transfers - 8% חשיבות**
- `transfers_in`, `transfers_balance` - מגמה

#### 6. **xGI (Expected Goal Involvements) - 7% חשיבות**
- `xGI_per_90` - איום התקפי

#### 7. **Other - 10% חשיבות**
- `threat`, `creativity`, `influence` - מדדי ICT
- `expected_goals`, `expected_assists` - צפי
- `clean_sheets`, `def_contrib` - הגנה

---

## 🔄 **איך החיזוי הסופי מחושב?**

```javascript
// חיזוי למשחק אחד
heuristic_per_game = form_5 + adjustments + fixture_multiplier

// חיזוי ל-3 מחזורים
heuristic_3gw = heuristic_per_game × 3

// חיזוי סופי (3 מחזורים)
final_prediction_3gw = (model_prediction_1gw × 3 × 0.2) + (heuristic_3gw × 0.8)
```

**למה 80% הוריסטי?**
- המודל יש לו R² שלילי (-0.024) = לא אמין
- החיזוי ההוריסטי מבוסס על מדדים מוכחים
- 80% הוריסטי = יותר אמין

**למה 3 מחזורים?**
- בדראפט, חשוב לתכנן לטווח קצר-בינוני
- 3 מחזורים = מספיק זמן לראות מגמות, לא יותר מדי
- מאפשר תכנון טוב יותר של העברות

---

## 📝 **דוגמה לחישוב:**

### שחקן: Haaland
- `form_5` = 9.72 נקודות/משחק
- `selected` = 70.8% (>50%)
- `transfers_in` = 66,623 (>10,000)
- `minutes` = 944 (>300)
- `ict_index` = 124.1 (>100)
- `xGI_per_90` = 1.12 (>0.5)

**חיזוי הוריסטי (למשחק אחד):**
```
= 9.72  // form_5 (בסיס)
+ 0.3   // selected > 20%
+ 0.4   // selected > 50%
+ 0.4   // transfers_balance > 5,000
+ 0.3   // transfers_balance > 20,000
+ 0.0   // minutes > 300 (לא מוריד)
+ 0.2   // ict_index > 120
+ 0.3   // xGI_per_90 > 0.5
× 1.1  // fixture_difficulty (נניח משחקים קלים)
= 12.0 נקודות למשחק
```

**חיזוי ל-3 מחזורים:**
```
= 12.0 × 3 = 36.0 נקודות
```

**חיזוי סופי (3 מחזורים):**
```
= (model_prediction_1gw × 3 × 0.2) + (36.0 × 0.8)
≈ 35 נקודות ל-3 מחזורים
```

---

## 🎓 **לסיכום:**

1. **חיזוי הוריסטי** = כללים פשוטים מבוססי ניסיון
2. **מודל Decision Tree** = 100+ features, אבל לא אמין (R² שלילי)
3. **החיזוי הסופי** = 20% מודל + 80% הוריסטי
4. **חיזוי ל-3 מחזורים** (לא 1!) - טוב יותר לתכנון דראפט
5. **המדד הכי חשוב** = `form_5` / `points_per_game_90` (40% חשיבות)
6. **מדדים נוספים חשובים** = selected, minutes, **transfers_balance** (לא transfers_in!), xGI, **fixture_difficulty**
7. **ICT Index** = חשיבות נמוכה (רק 1.29% במודל) - משתמשים רק אם מאוד גבוה/נמוך

